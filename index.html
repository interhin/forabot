<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>

<video id="local" autoplay muted playsinline></video>
<video id="remote" autoplay playsinline></video>

<script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>
<script>
  const peer = new Peer(undefined, {
    host: '37.195.249.18',
    port: 9000,
    path: '/peerjs',
    secure: true
  });

  peer.on('open', id => {
    console.log('My ID:', id);
    window.myPeerId = id;
  });

  navigator.mediaDevices.getUserMedia({ video: true, audio: true })
    .then(stream => {
      local.srcObject = stream;

      peer.on('call', call => {
        call.answer(stream);
        call.on('stream', s => remote.srcObject = s);
      });

      window.callUser = id => {
        const call = peer.call(id, stream);
        call.on('stream', s => remote.srcObject = s);
      };
    });
</script>

</body>
</html>
